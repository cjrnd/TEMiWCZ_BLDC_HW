Version 4
SHEET 1 1988 2100
WIRE 912 96 832 96
WIRE 976 96 912 96
WIRE 1168 96 1168 32
WIRE 1168 96 976 96
WIRE 1456 96 1168 96
WIRE 1792 96 1456 96
WIRE 1920 96 1792 96
WIRE 832 144 832 96
WIRE 1792 144 1792 96
WIRE 1632 160 1600 160
WIRE 1728 160 1696 160
WIRE -1536 176 -1744 176
WIRE 912 176 912 96
WIRE 1456 176 1456 96
WIRE -1344 192 -1472 192
WIRE -1536 208 -1568 208
WIRE 624 224 624 208
WIRE 624 224 592 224
WIRE 656 224 624 224
WIRE 752 224 736 224
WIRE 784 224 752 224
WIRE 1600 224 1600 160
WIRE 1600 224 1584 224
WIRE 1632 224 1600 224
WIRE 1728 224 1728 160
WIRE 1728 224 1712 224
WIRE 1744 224 1728 224
WIRE 1920 272 1920 256
WIRE -1888 288 -2192 288
WIRE 832 288 832 240
WIRE 912 288 912 240
WIRE 912 288 832 288
WIRE 976 288 976 272
WIRE 976 288 912 288
WIRE 1056 288 976 288
WIRE 1152 288 1136 288
WIRE 1168 288 1152 288
WIRE 1264 288 1248 288
WIRE 1328 288 1264 288
WIRE 1456 288 1456 240
WIRE 1456 288 1408 288
WIRE 1792 288 1792 240
WIRE 1792 288 1456 288
WIRE 1856 288 1792 288
WIRE 1920 288 1920 272
WIRE 1920 288 1856 288
WIRE -1888 304 -1888 288
WIRE -1840 304 -1888 304
WIRE -1744 304 -1744 176
WIRE -1744 304 -1776 304
WIRE -1696 304 -1744 304
WIRE -1568 304 -1568 208
WIRE -1568 304 -1632 304
WIRE 976 304 976 288
WIRE 624 320 624 224
WIRE 656 320 624 320
WIRE 752 320 752 224
WIRE 752 320 720 320
WIRE 1920 320 1920 288
WIRE -1840 336 -2016 336
WIRE -1744 336 -1776 336
WIRE -1584 336 -1632 336
WIRE 832 352 832 288
WIRE 1792 352 1792 288
WIRE 912 368 912 288
WIRE -1584 384 -1584 336
WIRE -1536 384 -1584 384
WIRE -1344 384 -1472 384
WIRE 1152 384 1152 288
WIRE 1168 384 1152 384
WIRE 1264 384 1264 288
WIRE 1264 384 1232 384
WIRE 1456 384 1456 288
WIRE -2016 400 -2016 336
WIRE -1744 416 -1744 336
WIRE -1536 416 -1744 416
WIRE 624 432 592 432
WIRE 656 432 624 432
WIRE 752 432 736 432
WIRE 784 432 752 432
WIRE 1648 432 1600 432
WIRE 1744 432 1728 432
WIRE 624 512 624 432
WIRE 656 512 624 512
WIRE 752 512 752 432
WIRE 752 512 720 512
WIRE 832 512 832 448
WIRE 912 512 912 432
WIRE 912 512 832 512
WIRE 976 512 976 480
WIRE 976 512 912 512
WIRE 992 512 976 512
WIRE 1456 512 1456 448
WIRE 1456 512 1408 512
WIRE 1792 512 1792 448
WIRE 1792 512 1456 512
WIRE 1920 512 1920 496
WIRE 1920 512 1792 512
WIRE 912 528 912 512
WIRE 1456 528 1456 512
WIRE 832 576 832 512
WIRE 1792 576 1792 512
WIRE -1520 704 -1728 704
WIRE 832 704 832 656
WIRE 1136 704 832 704
WIRE 1792 704 1792 656
WIRE 1792 704 1136 704
WIRE -1328 720 -1456 720
WIRE -1520 736 -1552 736
WIRE 192 800 96 800
WIRE -1872 816 -2176 816
WIRE -112 816 -208 816
WIRE 16 816 -32 816
WIRE 96 816 96 800
WIRE 96 816 16 816
WIRE -1872 832 -1872 816
WIRE -1824 832 -1872 832
WIRE -1728 832 -1728 704
WIRE -1728 832 -1760 832
WIRE -1680 832 -1728 832
WIRE -1552 832 -1552 736
WIRE -1552 832 -1616 832
WIRE -1824 864 -2000 864
WIRE -1728 864 -1760 864
WIRE -1568 864 -1616 864
WIRE 96 880 16 880
WIRE 112 880 96 880
WIRE -1568 912 -1568 864
WIRE -1520 912 -1568 912
WIRE -1328 912 -1456 912
WIRE -2000 928 -2000 864
WIRE -1728 944 -1728 864
WIRE -1520 944 -1728 944
FLAG -208 896 0
FLAG 192 800 vcc
FLAG 1168 32 vcc
FLAG 1136 704 0
FLAG 592 224 A
FLAG -512 576 0
FLAG -512 496 test
FLAG 912 288 out+
FLAG 1856 288 out-
FLAG 96 880 0
FLAG -704 1040 0
FLAG -704 960 testt
FLAG 592 432 _A
FLAG -1344 192 A
FLAG -1344 384 _A
FLAG -2192 368 0
FLAG -2016 480 0
FLAG 1328 288 bemf
FLAG -2176 896 0
FLAG -2000 1008 0
FLAG -1328 720 B
FLAG -1328 912 _B
FLAG 1584 224 B
FLAG 1600 432 _B
SYMBOL nmos 784 144 R0
SYMATTR InstName M1
SYMATTR Value IRF8721
SYMBOL res 1264 272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 100m
SYMBOL voltage -208 800 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 48
SYMBOL nmos 784 352 R0
SYMATTR InstName M2
SYMATTR Value IRF8721
SYMBOL nmos 1744 144 R0
SYMATTR InstName M3
SYMATTR Value IRF8721
SYMBOL nmos 1744 352 R0
SYMATTR InstName M4
SYMATTR Value IRF8721
SYMBOL res 816 560 R0
SYMATTR InstName R3
SYMATTR Value 1m
SYMBOL res 1776 560 R0
SYMATTR InstName R4
SYMATTR Value 1m
SYMBOL res 752 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {Rg}
SYMBOL res 752 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value {Rg}
SYMBOL res 1728 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value {Rg}
SYMBOL res 1744 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {Rg}
SYMBOL ind 1040 304 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 250µ
SYMBOL voltage -512 480 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(-1 1 0 250u 250u 1p 500u)
SYMBOL res 960 80 R0
SYMATTR InstName R9
SYMATTR Value 50
SYMBOL cap 960 208 R0
SYMATTR InstName C1
SYMATTR Value 10µ
SYMBOL res 960 288 R0
SYMATTR InstName R10
SYMATTR Value 50
SYMBOL cap 960 416 R0
SYMATTR InstName C2
SYMATTR Value 10µ
SYMBOL res 1904 80 R0
SYMATTR InstName R11
SYMATTR Value 50
SYMBOL cap 1904 208 R0
SYMATTR InstName C3
SYMATTR Value 10µ
SYMBOL res 1904 304 R0
SYMATTR InstName R12
SYMATTR Value 50
SYMBOL cap 1904 432 R0
SYMATTR InstName C4
SYMATTR Value 10µ
SYMBOL cap 0 816 R0
SYMATTR InstName C5
SYMATTR Value 500µ
SYMBOL cap 80 816 R0
SYMATTR InstName C6
SYMATTR Value 100n
SYMBOL res -16 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 100m
SYMBOL voltage -704 944 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE(0 {2*AMPL} 500 0 0 0)
SYMBOL diode 928 240 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMATTR Value VS-E5PH7506
SYMBOL diode 928 432 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D6
SYMATTR Value VS-E5PH7506
SYMBOL diode 1472 240 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
SYMATTR Value VS-E5PH7506
SYMBOL diode 1472 448 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D8
SYMATTR Value VS-E5PH7506
SYMBOL Digital\\and -1504 144 R0
SYMATTR InstName A1
SYMATTR SpiceLine tripdt=10n Vhigh={VH}
SYMBOL Digital\\diffschmitt -1840 256 R0
SYMATTR InstName A2
SYMATTR SpiceLine vt=0 vh=0 Vhigh={VH}
SYMBOL Digital\\and -1664 256 R0
SYMATTR InstName A3
SYMATTR SpiceLine td={dt} Vhigh={VH}
SYMBOL Digital\\and -1504 336 R0
SYMATTR InstName A4
SYMATTR SpiceLine tripdt=10n Vhigh={VH}
SYMBOL voltage 1312 288 R270
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value SINE(0 5 {freq} 0 0 30)
SYMBOL cap 1232 368 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value 1n
SYMATTR SpiceLine Rser=20
SYMBOL voltage -2176 800 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value SINE(0 {AMPL} 50 0 0 180)
SYMBOL voltage -2000 912 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value PULSE({-AMPL} {AMPL} 0 16u 16u 0 16u)
SYMBOL Digital\\and -1488 672 R0
SYMATTR InstName A5
SYMATTR SpiceLine tripdt=10n Vhigh={VH}
SYMBOL Digital\\diffschmitt -1824 784 R0
SYMATTR InstName A6
SYMATTR SpiceLine vt=0 vh=0 Vhigh={VH}
SYMBOL Digital\\and -1648 784 R0
SYMATTR InstName A7
SYMATTR SpiceLine td={dt} Vhigh={VH}
SYMBOL Digital\\and -1488 864 R0
SYMATTR InstName A8
SYMATTR SpiceLine tripdt=10n Vhigh={VH}
SYMBOL diode 720 304 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMBOL diode 720 496 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMBOL diode 1696 144 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMBOL diode 1712 336 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D4
SYMBOL voltage -2192 272 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value SINE(0 {AMPL} 50 0 0 0)
SYMBOL voltage -2016 384 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value PULSE({-AMPL} {AMPL} 0 16u 16u 0 16u)
TEXT -536 48 Left 2 !Vmod 0 Nmod SINE(0 {AMPL} 50 0 0 180) \nVmodneg 0 NmodNeg SINE(0 {AMPL} 50 0 0 0 0)\nVcar ncar 0 PULSE(-1 1 0 25u 25u 1p 50u)\nBtopactrl NtopA 0 V = IF(V(nmod) < {DUTY}*V(ncar)  , {VGATE}, 0)\nBbotactrl NbotA 0 V =  IF(V(nmod) > {DUTY}*V(ncar)  , {VGATE+V(out+)},0) \nBtopbctrl NtopB 0 V = IF(V(nmodneg) > {DUTY}*V(ncar) , {VGATE},0)\nBbotbctrl Nbotb 0 V = IF(V(nmodneg) < {DUTY}*V(ncar)  , {VGATE+V(out-)}, 0)
TEXT -528 632 Left 2 !.tran 40m
TEXT -536 304 Left 2 !.param AMPL=.9 DUTY=0.01 VGATE=10 freq=50Rg Rg=10
TEXT -536 368 Left 2 !.param DT=1u CDT={DT/(0.691*1k)}
TEXT -1128 160 Left 2 !.param VH=30
